module.exports=[18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},874,(a,b,c)=>{b.exports=a.x("buffer",()=>require("buffer"))},54799,(a,b,c)=>{b.exports=a.x("crypto",()=>require("crypto"))},87809,a=>{"use strict";a.s(["default",()=>f]);var b=a.i(87924),c=a.i(72131);let d=(0,a.i(41317).generateClient)(),e=["09:00","09:30","10:00","10:30","11:00","11:30"];function f({inviteToken:a,onRegistrationComplete:g,prefillEmail:h}={}){let[i,j]=(0,c.useState)({firstName:"",lastName:"",email:h||"",phone:"",numberOfKids:0,timeSlot:"",needsChildcare:!1,referredBy:"",children:[]}),[k,l]=(0,c.useState)({}),[m,n]=(0,c.useState)({}),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(!1);(0,c.useEffect)(()=>{s()},[]),(0,c.useEffect)(()=>{let a=[];for(let b=0;b<i.numberOfKids;b++)a.push(i.children[b]||{age:1,gender:"boy"});j(b=>({...b,children:a}))},[i.numberOfKids]);let s=async()=>{try{let{data:a}=await d.models.TimeSlotConfig.list(),b={};a.forEach(a=>{b[a.timeSlot]={max:a.maxCapacity||0,current:a.currentRegistrations||0}}),l(b)}catch(a){console.error("Error loading time slot capacities:",a)}},t=async()=>{let a={};i.firstName.trim()||(a.firstName="First name is required"),i.lastName.trim()||(a.lastName="Last name is required"),i.email.trim()||(a.email="Email is required"),i.phone.trim()||(a.phone="Phone number is required"),i.timeSlot||(a.timeSlot="Please select a time slot"),i.numberOfKids<0&&(a.numberOfKids="Number of kids cannot be negative"),i.numberOfKids>0&&i.children.forEach((b,c)=>{(b.age<1||b.age>18)&&(a[`child_${c}_age`]="Age must be between 1 and 18")});try{let{data:b}=await d.models.Registration.list({filter:{email:{eq:i.email}}});b.length>0&&(a.email="Someone is already registered with this email address")}catch(a){console.error("Error checking email:",a)}try{let{data:b}=await d.models.Registration.list({filter:{phone:{eq:i.phone}}});b.length>0&&(a.phone="Someone is already registered with this phone number")}catch(a){console.error("Error checking phone:",a)}let b=k[i.timeSlot];return b&&b.current>=b.max&&(a.timeSlot="This time slot is full"),n(a),0===Object.keys(a).length},u=async b=>{b.preventDefault(),p(!0);try{if(!await t())return void p(!1);let b=await d.models.Registration.create({firstName:i.firstName,lastName:i.lastName,email:i.email,phone:i.phone,numberOfKids:i.numberOfKids,timeSlot:i.timeSlot,needsChildcare:i.needsChildcare,referredBy:i.referredBy||void 0,inviteToken:a,registrationDate:new Date().toISOString()});if(b.data){i.numberOfKids>0&&await Promise.all(i.children.map(a=>d.models.Child.create({registrationId:b.data.id,age:a.age,gender:a.gender})));let a=k[i.timeSlot];if(a){let{data:b}=await d.models.TimeSlotConfig.list({filter:{timeSlot:{eq:i.timeSlot}}});b[0]&&await d.models.TimeSlotConfig.update({id:b[0].id,currentRegistrations:a.current+1})}r(!0),g&&g()}}catch(a){console.error("Error submitting registration:",a),n({submit:"An error occurred while submitting your registration. Please try again."})}finally{p(!1)}};return q?(0,b.jsx)("div",{className:"max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-md",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-green-600 mb-4",children:"Registration Successful!"}),(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:"Thank you for registering for the Christmas Store. You will receive a confirmation email shortly."}),(0,b.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Name:"})," ",i.firstName," ",i.lastName]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Email:"})," ",i.email]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Time Slot:"})," ",i.timeSlot]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Number of Children:"})," ",i.numberOfKids]}),i.needsChildcare&&(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Childcare:"})," Yes"]})]})]})}):(0,b.jsxs)("div",{className:"max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-center mb-6 text-red-600",children:"Christmas Store Registration"}),(0,b.jsxs)("form",{onSubmit:u,className:"space-y-6",children:[m.submit&&(0,b.jsx)("div",{className:"bg-red-50 p-4 rounded-lg text-red-600",children:m.submit}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),(0,b.jsx)("input",{type:"text",value:i.firstName,onChange:a=>j(b=>({...b,firstName:a.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-transparent",required:!0}),m.firstName&&(0,b.jsx)("p",{className:"text-red-500 text-sm mt-1",children:m.firstName})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),(0,b.jsx)("input",{type:"text",value:i.lastName,onChange:a=>j(b=>({...b,lastName:a.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-transparent",required:!0}),m.lastName&&(0,b.jsx)("p",{className:"text-red-500 text-sm mt-1",children:m.lastName})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),(0,b.jsx)("input",{type:"email",value:i.email,onChange:a=>j(b=>({...b,email:a.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-transparent",required:!0}),m.email&&(0,b.jsx)("p",{className:"text-red-500 text-sm mt-1",children:m.email})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number *"}),(0,b.jsx)("input",{type:"tel",value:i.phone,onChange:a=>j(b=>({...b,phone:a.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-transparent",required:!0}),m.phone&&(0,b.jsx)("p",{className:"text-red-500 text-sm mt-1",children:m.phone})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Children (18 and under) *"}),(0,b.jsx)("input",{type:"number",min:"0",max:"20",value:i.numberOfKids,onChange:a=>j(b=>({...b,numberOfKids:parseInt(a.target.value)||0})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-transparent",required:!0}),m.numberOfKids&&(0,b.jsx)("p",{className:"text-red-500 text-sm mt-1",children:m.numberOfKids})]}),i.numberOfKids>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Children Information"}),(0,b.jsx)("div",{className:"space-y-4",children:i.children.map((a,c)=>(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Child ",c+1," Age"]}),(0,b.jsx)("input",{type:"number",min:"1",max:"18",value:a.age,onChange:a=>{let b=[...i.children];b[c].age=parseInt(a.target.value)||1,j(a=>({...a,children:b}))},className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-transparent",required:!0}),m[`child_${c}_age`]&&(0,b.jsx)("p",{className:"text-red-500 text-sm mt-1",children:m[`child_${c}_age`]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Child ",c+1," Gender"]}),(0,b.jsxs)("select",{value:a.gender,onChange:a=>{let b=[...i.children];b[c].gender=a.target.value,j(a=>({...a,children:b}))},className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-transparent",required:!0,children:[(0,b.jsx)("option",{value:"boy",children:"Boy"}),(0,b.jsx)("option",{value:"girl",children:"Girl"})]})]})]},c))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preferred Time Slot *"}),(0,b.jsxs)("select",{value:i.timeSlot,onChange:a=>j(b=>({...b,timeSlot:a.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-transparent",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Select a time slot"}),e.map(a=>{let c=k[a],d=c&&c.current>=c.max,e=c?` (${c.current}/${c.max} registered)`:"";return(0,b.jsxs)("option",{value:a,disabled:d,children:[a,e,d?" - FULL":""]},a)})]}),m.timeSlot&&(0,b.jsx)("p",{className:"text-red-500 text-sm mt-1",children:m.timeSlot})]}),(0,b.jsx)("div",{children:(0,b.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:i.needsChildcare,onChange:a=>j(b=>({...b,needsChildcare:a.target.checked})),className:"rounded border-gray-300 text-red-600 shadow-sm focus:border-red-300 focus:ring focus:ring-red-200 focus:ring-opacity-50"}),(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"I need childcare during my shopping time"})]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Were you referred by any agency or person? (optional)"}),(0,b.jsx)("input",{type:"text",value:i.referredBy,onChange:a=>j(b=>({...b,referredBy:a.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Agency name or person's name"})]}),(0,b.jsx)("button",{type:"submit",disabled:o,className:"w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Submitting...":"Register for Christmas Store"})]})]})}}];

//# sourceMappingURL=%5Broot-of-the-server%5D__efbe9378._.js.map